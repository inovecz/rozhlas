; Supervisor program definition for the Control Tab serial listener.

[program:rozhlas_control_tab_listener]
directory=/opt/rozhlas
command=/usr/bin/env bash -lc 'source /etc/rozhlas/rozhlas.env && cd /opt/rozhlas && PYTHON_BIN=${PYTHON_BIN:-python3}; args=(daemons/control_tab_listener.py --port "${CONTROL_TAB_SERIAL_PORT:?CONTROL_TAB_SERIAL_PORT is required}" --baudrate "${CONTROL_TAB_SERIAL_BAUDRATE:-115200}" --bytesize "${CONTROL_TAB_SERIAL_BYTESIZE:-8}" --parity "${CONTROL_TAB_SERIAL_PARITY:-N}" --stopbits "${CONTROL_TAB_SERIAL_STOPBITS:-1}" --timeout-serial "${CONTROL_TAB_SERIAL_TIMEOUT:-0.2}" --write-timeout "${CONTROL_TAB_SERIAL_WRITE_TIMEOUT:-1}" --poll "${CONTROL_TAB_POLL_INTERVAL:-0.05}" --graceful "${CONTROL_TAB_GRACEFUL_TIMEOUT:-5}" --retry-backoff "${CONTROL_TAB_RETRY_BACKOFF_MS:-250}" --project-root /opt/rozhlas --artisan-bin "${ARTISAN_BIN:-php}" --artisan-path "${ARTISAN_PATH:-artisan}" --artisan-command "${CTAB_ARTISAN_COMMAND:-ctab:test-send}"); [[ -n "${CONTROL_TAB_WEBHOOK:-}" ]] && args+=(--webhook "${CONTROL_TAB_WEBHOOK}"); [[ -n "${CONTROL_TAB_TOKEN:-}" ]] && args+=(--token "${CONTROL_TAB_TOKEN}"); [[ -n "${CONTROL_TAB_TIMEOUT:-}" ]] && args+=(--timeout "${CONTROL_TAB_TIMEOUT}"); [[ "${CONTROL_TAB_SIMULATE:-}" == "1" || "${CONTROL_TAB_SIMULATE:-}" == "true" ]] && args+=(--simulate); exec "$PYTHON_BIN" "${args[@]}"'
autostart=true
autorestart=true
startsecs=3
stopwaitsecs=10
user=rozhlas
redirect_stderr=true
stdout_logfile=/var/log/rozhlas/control_tab_listener.log
environment=APP_ENV="production",PYTHONPATH="/opt/rozhlas/python-client/src"
